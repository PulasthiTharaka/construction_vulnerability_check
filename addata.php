<?php
require_once("./connection.php");

$mysqlConnection = connect();
$email = $_POST["email"] ?? null;
$password = $_POST["password"] ?? null;

if ($email !== null && $password !== null) {
    // Use prepared statements to prevent SQL injection
    $query = "SELECT * FROM admin WHERE email = ? AND password = ?";
    $stmt = mysqli_prepare($mysqlConnection, $query);

    // Check if the statement was prepared successfully
    if ($stmt) {
        // Bind the parameters and execute the query
        mysqli_stmt_bind_param($stmt, "ss", $email, $password);
        mysqli_stmt_execute($stmt);

        // Fetch the results
        mysqli_stmt_store_result($stmt);

        if (mysqli_stmt_num_rows($stmt) > 0) {
            // Login successful - redirect to the admin page
            $row = mysqli_fetch_assoc($stmt);
            header("Location: Admin.php?adId=" . $row['adId']);
        } else {
            echo "Login Failed";
        }

        // Close the statement
        mysqli_stmt_close($stmt);
    } else {
        echo "ERROR: " . mysqli_error($mysqlConnection);
    }

    // Close the database connection
    mysqli_close($mysqlConnection);
}
?>
 
has context menu
Compose